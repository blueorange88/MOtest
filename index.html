<!DOCTYPE html><html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>시간 편집 테스트</title>
  <style>
    body { font-family: sans-serif; margin: 0; padding: 20px; background: #f5f5f5; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; background: #fff; }
    th, td { border: 1px solid #ccc; padding: 10px; text-align: center; }
    th { background: #0d1b2a; color: #fff; cursor: pointer; }
    td.time-cell { background: #f0f0f0; cursor: pointer; }
    .popup, .overlay {
      display: none;
      position: fixed;
      left: 0; top: 0; right: 0; bottom: 0;
      justify-content: center;
      align-items: center;
    }
    .overlay { background: rgba(0,0,0,0.5); z-index: 9; }
    .popup {
      z-index: 10; background: white; padding: 20px; border-radius: 8px;
      max-width: 300px; width: 90%; box-shadow: 0 0 10px rgba(0,0,0,0.2);
    }
    .popup h3 { margin-bottom: 10px; }
    .popup label { display: block; margin: 10px 0; }
    .popup select, .popup input { width: 100%; padding: 5px; }
    .button-row { display: flex; justify-content: space-between; margin-top: 15px; }
    .button-row button { padding: 6px 12px; }
  </style>
</head>
<body><h2>시간 편집 테이블</h2>
<table id="schedule">
  <thead>
    <tr>
      <th id="headerTime">시간</th>
      <th>월</th>
      <th>화</th>
      <th>수</th>
    </tr>
  </thead>
  <tbody></tbody>
</table><!-- 팝업: 시간 범위 설정 --><div class="overlay" id="overlay"></div>
<div class="popup" id="popupRange">
  <h3>시간 범위 설정</h3>
  <label>시작 시각:
    <input type="time" id="rangeStart" value="06:00">
  </label>
  <label>종료 시각:
    <input type="time" id="rangeEnd" value="13:00">
  </label>
  <div class="button-row">
    <button onclick="applyTimeRange()">적용</button>
    <button onclick="closePopup()">취소</button>
  </div>
</div><!-- 팝업: 분 설정 --><div class="popup" id="popupMinute">
  <h3>분 선택</h3>
  <label>분 선택:
    <select id="minuteSelect">
      <option value="00">00</option>
      <option value="10">10</option>
      <option value="20">20</option>
      <option value="30">30</option>
      <option value="40">40</option>
      <option value="50">50</option>
    </select>
  </label>
  <div class="button-row">
    <button onclick="saveMinute()">저장</button>
    <button onclick="closePopup()">취소</button>
  </div>
</div><script>
  let currentTimeCell = null;

  document.getElementById('headerTime').onclick = () => {
    document.getElementById('popupRange').style.display = 'flex';
    document.getElementById('overlay').style.display = 'block';
  };

  function applyRangeCurr() {
  const s = parseInt(document.getElementById('rangeStartHour').value, 10);
  const e = parseInt(document.getElementById('rangeEndHour').value, 10);

  if (e <= s) {
    alert('종료 시간은 시작 시간보다 커야 합니다.');
    return;
  }

  if (e - s < 3) {
    alert('최소 3시간 이상이어야 합니다.');
    return;
  }

  scheduleStart = s;
  scheduleEnd = e;

  buildCurr();
  buildNext();
  buildLast();
  loadCurr();
  highlightToday();
  updateToday();
  initTimeLine();
  closePopup();
}

  function openMinutePopup(td) {
    currentTimeCell = td;
    document.getElementById('popupMinute').style.display = 'flex';
    document.getElementById('overlay').style.display = 'block';
  }

  function saveMinute() {
    const min = document.getElementById('minuteSelect').value;
    const hour = currentTimeCell.textContent.split(':')[0];
    currentTimeCell.textContent = `${hour}:${min}`;
    closePopup();
  }

  function closePopup() {
    document.querySelectorAll('.popup').forEach(p => p.style.display = 'none');
    document.getElementById('overlay').style.display = 'none';
  }
</script></body>
</html>
